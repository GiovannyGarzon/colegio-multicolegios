{% extends "sitio/base_publico.html" %}
{% load static %}

{% block title %}
  {% if request.school %}Inicio | {{ request.school.name }}{% else %}Inicio{% endif %}
{% endblock %}

{% block extra_css %}
<style>
/* ================= HERO ================= */
.hero-home{
  position:relative;
  min-height:62vh;
  background-size:cover;
  background-position:center;
  display:flex;
  align-items:center;
  justify-content:center;
}

/* Overlay usando colores del colegio */
.hero-overlay{
  position:absolute;
  inset:0;
  background: linear-gradient(
    120deg,
    var(--primary-color),
    var(--secondary-color)
  );
  opacity:.78;
}

.hero-inner{
  position:relative;
  max-width:1100px;
  width:100%;
  padding:56px 20px;
  color:#fff;
}

.hero-text{ max-width:720px; }

.hero-kicker{
  font-size:.85rem;
  text-transform:uppercase;
  letter-spacing:.12em;
  opacity:.95;
}

.hero-text h1{
  margin:10px 0 12px;
  font-size:2.4rem;
  font-weight:800;
}

.hero-text p{
  max-width:620px;
  margin-bottom:18px;
  line-height:1.6;
}

/* botones hero */
.hero-actions{
  display:flex;
  gap:10px;
  flex-wrap:wrap;
  margin-bottom:18px;
}

.btnx{
  padding:10px 18px;
  border-radius:999px;
  text-decoration:none;
  font-weight:700;
}

.btnx-primary{
  background: var(--button-color);
  color:#fff;
}

.btnx-outline{
  border:1px solid #fff;
  color:#fff;
}

/* métricas */
.hero-metrics{
  display:flex;
  gap:22px;
  flex-wrap:wrap;
  font-size:.9rem;
}
.hero-metrics strong{
  display:block;
  font-size:1.15rem;
}

/* ================= BLOQUES ================= */
.blocks{
  display:flex;
  flex-direction:column;
}

.block{
  padding:70px 0;
}

/* colores dinámicos por colegio */
.block:nth-child(odd){
  background: var(--primary-color);
}
.block:nth-child(even){
  background: var(--secondary-color);
}

.block-inner{
  max-width:1100px;
  margin:auto;
  padding:0 20px;
  display:flex;
  align-items:center;
  gap:40px;
}

.block:nth-child(even) .block-inner{
  flex-direction:row-reverse;
}

/* IMAGEN */
.block-media{
  flex:0 0 440px;
  max-width:440px;
  height:320px;
  border-radius:18px;
  overflow:hidden;
  box-shadow:0 18px 35px rgba(0,0,0,.35);
}
.block-media img{
  width:100%;
  height:100%;
  object-fit:cover;
  object-position:center;
}

/* TEXTO */
.block-text{
  flex:1;
  color:#fff;
}
.block-text h2{
  font-size:2.1rem;
  font-weight:800;
  margin-bottom:12px;
}
.block-text p{
  max-width:620px;
  font-size:1.05rem;
  line-height:1.6;
  margin-bottom:18px;
}

/* CTA */
.btn-cta{
  background: var(--button-color);
  color:#fff;
  padding:12px 28px;
  border-radius:999px;
  font-weight:800;
  text-decoration:none;
}

/* responsive */
@media(max-width:980px){
  .block-inner{ flex-direction:column; }
  .block:nth-child(even) .block-inner{ flex-direction:column; }
  .block-media{ width:100%; height:260px; }
}

/* ================= TARJETAS ================= */
.home-main{
  max-width:1100px;
  margin:60px auto;
  padding:0 20px;
}

.home-grid{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(230px,1fr));
  gap:18px;
}

.home-card{
  background:#fff;
  border-radius:14px;
  padding:18px;
  box-shadow:0 10px 22px rgba(0,0,0,.08);
}

.home-card a{
  color: var(--primary-color);
  font-weight:700;
  text-decoration:none;
}

/* WhatsApp */
.btn-whatsapp{
  position:fixed;
  bottom:18px;
  right:18px;
  background:#25d366;
  color:#fff;
  padding:10px 16px;
  border-radius:999px;
  font-weight:800;
  text-decoration:none;
  z-index:50;
}
</style>
{% endblock %}

{% block content %}

<!-- HERO -->
<section id="hero-home" class="hero-home"
{% if slides and slides.0.image %}
style="background-image:url('{{ slides.0.image.url }}');"
{% endif %}
>
  <div class="hero-overlay"></div>

  <div class="hero-inner">
    <div class="hero-text">
      <div class="hero-kicker">
        {{ page.subtitle|default:"Formando con amor, conocimiento y valores" }}
      </div>

      <h1>{{ page.title|default:request.school.name }}</h1>

      <p>{{ page.content|default:"Acompañamos los primeros años de tus hijos en un ambiente seguro, humano y pedagógico." }}</p>

      <div class="hero-actions">
        <a href="{% url 'sitio:admisiones' %}" class="btnx btnx-primary">
          Proceso de admisiones
        </a>
        <a href="{% url 'sitio:nosotros' %}" class="btnx btnx-outline">
          Conoce nuestro proyecto
        </a>
      </div>

      <div class="hero-metrics">
        <div><strong>+10</strong>Años de experiencia</div>
        <div><strong>Grados</strong>Prejardín a transición</div>
        <div><strong>Familias</strong>Acompañadas</div>
      </div>
    </div>
  </div>
</section>

<!-- BLOQUES -->
<section class="blocks">
{% for b in blocks|slice:":2" %}
  <section class="block">
    <div class="block-inner">
      <div class="block-media">
        <img src="{{ b.image.url }}" alt="{{ b.title }}">
      </div>
      <div class="block-text">
        <h2>{{ b.title }}</h2>
        <p>{{ b.text|linebreaksbr }}</p>

        {% if b.button_url %}
          <a href="{{ b.button_url }}" class="btn-cta">
            {{ b.button_text|default:"Conocer más" }}
          </a>
        {% endif %}
      </div>
    </div>
  </section>
{% endfor %}
</section>

<!-- TARJETAS -->
<main class="home-main">
  <div class="home-grid">
    <div class="home-card">
      <h3>Proyecto Educativo</h3>
      <a href="{% url 'sitio:nosotros' %}">Ver más</a>
    </div>
    <div class="home-card">
      <h3>Admisiones</h3>
      <a href="{% url 'sitio:admisiones' %}">Ver más</a>
    </div>
    <div class="home-card">
      <h3>Noticias</h3>
      <a href="{% url 'sitio:noticias' %}">Ver más</a>
    </div>
    <div class="home-card">
      <h3>Contacto</h3>
      <a href="{% url 'sitio:contacto' %}">Contactar</a>
    </div>
  </div>
</main>

{% if config.whatsapp %}
<a href="https://wa.me/{{ config.whatsapp|cut:'+' }}" class="btn-whatsapp">
  WhatsApp
</a>
{% endif %}

{% endblock %}

{% block extra_js %}
<script>
document.addEventListener('DOMContentLoaded',()=>{
  const hero=document.getElementById('hero-home');
  const images=[
    {% for s in slides %}
      "{{ s.image.url }}"{% if not forloop.last %},{% endif %}
    {% endfor %}
  ];
  if(!images.length) return;

  let i=0;
  setInterval(()=>{
    i=(i+1)%images.length;
    hero.style.backgroundImage=`url('${images[i]}')`;
  },6000);
});
</script>
{% endblock %}