{% extends "colegioapp/base.html" %}
{% block title %}Buscar persona{% endblock %}

{% block content %}
<main style="max-width:1000px;margin:0 auto;padding:24px 16px;">

  <h2 style="margin:0 0 14px;color:var(--primary-color);">
    Buscar persona
  </h2>

  <form method="get" action="" style="margin-bottom:18px;display:flex;gap:8px;flex-wrap:wrap;">
    <input type="text"
           name="q"
           value="{{ q }}"
           placeholder="Nombre, apellido, identificación, usuario..."
           style="
             padding:7px 10px;
             border-radius:8px;
             border:1px solid #b0bec5;
             min-width:260px;
             flex:1 1 260px;
           ">
    <button type="submit"
            style="
              padding:7px 16px;
              border-radius:8px;
              border:none;
              background:var(--primary-color);
              color:#fff;
              cursor:pointer;
              font-weight:500;
            ">
      Buscar
    </button>
  </form>

  {% if q %}
    <p style="margin-bottom:12px;font-size:0.95rem;color:#455a64;">
      Resultados para: <strong>{{ q }}</strong>
    </p>
  {% endif %}

  <div style="
        display:grid;
        grid-template-columns:1fr 1fr;
        gap:18px;
        margin-top:10px;
      ">

    <!-- Estudiantes -->
    <section style="
          background:#fff;
          border-radius:12px;
          padding:14px 16px;
          box-shadow:0 3px 10px rgba(0,0,0,0.06);
        ">
      <h3 style="margin:0 0 10px;color:var(--primary-color);">Estudiantes</h3>
      {% if estudiantes %}
        <ul style="list-style:none;padding:0;margin:0;">
          {% for e in estudiantes %}
            <li style="padding:8px 0; border-bottom:1px solid #eceff1;">
              <div><strong>{{ e.apellidos }} {{ e.nombres }}</strong></div>
              <div style="font-size:0.85rem;color:#607d8b;">
                ID: {{ e.identificacion }}<br>
                Curso: {{ e.curso|default:"Sin curso" }}
              </div>
              <div style="margin-top:4px;">
                <a href="{% url 'academico:estudiante_detail' e.id %}"
                   style="
                     font-size:0.8rem;
                     margin-right:8px;
                     color:var(--secondary-color);
                     text-decoration:none;
                   ">
                  Ver ficha
                </a>
              </div>
            </li>
          {% endfor %}
        </ul>
      {% else %}
        <p style="font-size:0.9rem;color:#90a4ae;margin:4px 0 0;">
          Sin resultados de estudiantes.
        </p>
      {% endif %}
    </section>

    <!-- Docentes / Usuarios -->
    <section style="display:flex;flex-direction:column;gap:12px;">

      <!-- Docentes -->
      <div style="
            background:#fff;
            border-radius:12px;
            padding:14px 16px;
            box-shadow:0 3px 10px rgba(0,0,0,0.06);
          ">
        <h3 style="margin:0 0 10px;color:var(--primary-color);">Docentes</h3>
        {% if docentes %}
          <ul style="list-style:none;padding:0;margin:0;">
            {% for d in docentes %}
              <li style="padding:8px 0; border-bottom:1px solid #eceff1;">
                <div><strong>{{ d.apellidos }} {{ d.nombres }}</strong></div>
                <div style="font-size:0.85rem;color:#607d8b;">
                  ID: {{ d.identificacion }}<br>
                  Curso asignado: {{ d.curso_asignado|default:"—" }}
                </div>
              </li>
            {% endfor %}
          </ul>
        {% else %}
          <p style="font-size:0.9rem;color:#90a4ae;margin:4px 0 0;">
            Sin resultados de docentes.
          </p>
        {% endif %}
      </div>

      <!-- Usuarios del sistema -->
      <div style="
            background:#fff;
            border-radius:12px;
            padding:14px 16px;
            box-shadow:0 3px 10px rgba(0,0,0,0.06);
          ">
        <h3 style="margin:0 0 10px;color:var(--primary-color);">
          Usuarios del sistema
        </h3>
        {% if usuarios %}
          <ul style="list-style:none;padding:0;margin:0;">
            {% for u in usuarios %}
              <li style="padding:8px 0; border-bottom:1px solid #eceff1;">
                <div><strong>{{ u.get_full_name|default:u.username }}</strong></div>
                <div style="font-size:0.85rem;color:#607d8b;">
                  Usuario: {{ u.username }}<br>
                  Email: {{ u.email|default:"—" }}
                </div>
              </li>
            {% endfor %}
          </ul>
        {% else %}
          <p style="font-size:0.9rem;color:#90a4ae;margin:4px 0 0;">
            Sin resultados de usuarios.
          </p>
        {% endif %}
      </div>

    </section>
  </div>
</main>
{% endblock %}