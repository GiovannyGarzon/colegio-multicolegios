{% extends "colegioapp/base.html" %}
{% load humanize %}

{% block title %}
  Reporte: Pagos por Año |
  {% if request.school %}{{ request.school.name }}{% else %}Cartera{% endif %}
{% endblock %}

{% block content %}
<main>
  <h2 style="color: var(--primary-color);">
    Pagos por Año Económico
  </h2>

  <!-- Totales por Año -->
  <h3 style="margin-top:10px; color: var(--secondary-color);">
    Totales por Año
  </h3>

  <table style="
      width:600px;
      margin:10px auto;
      border-collapse:collapse;
      background:#fff;
      border-radius:12px;
      overflow:hidden;
      box-shadow:0 4px 12px rgba(0,0,0,0.06);
  ">
    <thead style="background: color-mix(in srgb, var(--primary-color) 14%, white);">
      <tr>
        <th style="padding:12px; text-align:left;">Año</th>
        <th style="padding:12px; text-align:right;">Total</th>
      </tr>
    </thead>
    <tbody>
      {% for r in totales_anio %}
      <tr style="border-top:1px solid #eceff1;">
        <td style="padding:10px 12px;">{{ r.anio }}</td>
        <td style="padding:10px 12px; text-align:right; font-weight:800; color: var(--primary-color);">
          ${{ r.total|floatformat:0|intcomma }}
        </td>
      </tr>
      {% empty %}
      <tr>
        <td colspan="2" style="padding:14px; text-align:center; color:#607d8b;">
          Sin datos
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>

  <!-- Totales por Año y Concepto -->
  <h3 style="margin-top:22px; color: var(--secondary-color);">
    Totales por Año y Concepto
  </h3>

  <table style="
      width:800px;
      margin:10px auto;
      border-collapse:collapse;
      background:#fff;
      border-radius:12px;
      overflow:hidden;
      box-shadow:0 4px 12px rgba(0,0,0,0.06);
  ">
    <thead style="background: color-mix(in srgb, var(--primary-color) 14%, white);">
      <tr>
        <th style="padding:12px; text-align:left;">Año</th>
        <th style="padding:12px; text-align:left;">Concepto</th>
        <th style="padding:12px; text-align:right;">Total</th>
      </tr>
    </thead>
    <tbody>
      {% for r in totales_anio_concepto %}
      <tr style="border-top:1px solid #eceff1;">
        <td style="padding:10px 12px;">{{ r.anio }}</td>
        <td style="padding:10px 12px;">{{ r.concepto }}</td>
        <td style="padding:10px 12px; text-align:right; font-weight:800; color: var(--primary-color);">
          ${{ r.total|floatformat:0|intcomma }}
        </td>
      </tr>
      {% empty %}
      <tr>
        <td colspan="3" style="padding:14px; text-align:center; color:#607d8b;">
          Sin datos
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>

  <!-- Volver -->
  <div style="text-align:center; margin-top:18px;">
    <a href="{% url 'cartera:reportes' %}"
       style="
         padding:10px 18px;
         background: var(--secondary-color);
         color:#fff;
         text-decoration:none;
         border-radius:8px;
         font-weight:800;
       ">
      ⬅ Volver a Reportes
    </a>
  </div>
</main>
{% endblock content %}