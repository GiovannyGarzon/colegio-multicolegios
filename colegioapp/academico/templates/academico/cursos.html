{% extends "colegioapp/base.html" %}
{% load static %}

{% block title %}Cursos | {{ request.school.nombre|default:"Colegio" }}{% endblock %}

{% block content %}
<main>
  <h2 style="max-width:900px;margin:10px auto 16px;font-size:1.6rem;color:#111827;">
    Cursos
  </h2>

  <div style="max-width:900px; margin:0 auto 20px;">
    <a href="{% url 'academico:home' %}"
       style="
         display:inline-block;
         background:#2563eb;          /* azul neutro */
         color:white;
         padding:10px 16px;
         border-radius:8px;
         text-decoration:none;
         font-size:0.95rem;
         transition:background 0.2s, transform 0.1s;
       "
       onmouseover="this.style.background='#1d4ed8';"
       onmouseout="this.style.background='#2563eb';"
    >
       ← Volver al módulo académico
    </a>
  </div>

  <!-- Filtro -->
  <form method="get"
        style="
          max-width:700px;
          margin:0 auto 18px;
          display:flex;
          gap:10px;
          align-items:center;
          flex-wrap:wrap;
        ">
    <input
      type="text" name="q" value="{{ q }}"
      placeholder="Buscar por nombre, grado o jornada"
      style="
        flex:1;
        min-width:220px;
        padding:10px 12px;
        border:1px solid #d1d5db;
        border-radius:8px;
        font-size:0.95rem;
      "
    />

    <button type="submit"
            style="
              padding:10px 16px;
              background:#2563eb;      /* azul neutro */
              color:white;
              border:none;
              border-radius:8px;
              cursor:pointer;
              font-size:0.95rem;
            ">
      Filtrar
    </button>

    <a href="{% url 'academico:cursos' %}"
       style="
         padding:10px 16px;
         background:#9ca3af;          /* gris neutro */
         color:white;
         border-radius:8px;
         text-decoration:none;
         font-size:0.95rem;
       ">
      Limpiar
    </a>

    <a href="{% url 'academico:curso_create' %}"
       style="
         padding:10px 16px;
         background:#16a34a;          /* verde neutro */
         color:white;
         text-decoration:none;
         border-radius:8px;
         font-size:0.95rem;
       ">
       + Nuevo Curso
    </a>
  </form>

  <!-- Tabla -->
  <div style="max-width:900px;margin:0 auto;">
    <div style="
      overflow-x:auto;
      background:white;
      border-radius:12px;
      box-shadow:0 4px 12px rgba(15,23,42,0.06);
      border:1px solid #e5e7eb;
    ">
      <table style="width:100%; border-collapse:collapse; font-size:0.95rem;">
        <thead style="background:#eff6ff; border-bottom:1px solid #e5e7eb;">
          <tr>
            <th style="text-align:left; padding:12px; color:#374151;">Grado</th>
            <th style="text-align:left; padding:12px; color:#374151;">Nombre del Curso</th>
            <th style="text-align:left; padding:12px; color:#374151;">Jornada</th>
            <th style="text-align:left; padding:12px; color:#374151;">Docente(s) Asignado(s)</th>
          </tr>
        </thead>
        <tbody>
          {% if page_obj.object_list %}
            {% for c in page_obj.object_list %}
            <tr style="border-top:1px solid #e5e7eb; {% if forloop.counter0|divisibleby:2 %}background:#f9fafb;{% endif %}">
              <td style="padding:10px 12px; color:#111827;">{{ c.grado }}</td>
              <td style="padding:10px 12px; color:#111827;">{{ c.nombre }}</td>
              <td style="padding:10px 12px; color:#4b5563;">{{ c.jornada|default:"—" }}</td>
              <td style="padding:10px 12px; color:#4b5563;">
                {% if c.docente_set.all %}
                  {% for d in c.docente_set.all %}
                    <div>{{ d.nombres }} {{ d.apellidos }}</div>
                  {% empty %}
                    <em style="color:#9ca3af;">Sin docente asignado</em>
                  {% endfor %}
                {% else %}
                  <em style="color:#9ca3af;">Sin docente asignado</em>
                {% endif %}
              </td>
            </tr>
            {% endfor %}
          {% else %}
            <tr>
              <td colspan="4"
                  style="
                    padding:14px;
                    text-align:center;
                    color:#6b7280;
                    background:#f9fafb;
                  ">
                No se encontraron cursos.
              </td>
            </tr>
          {% endif %}
        </tbody>
      </table>
    </div>

    <!-- Paginación -->
    {% if page_obj.paginator.num_pages > 1 %}
    <div style="display:flex; justify-content:center; gap:6px; margin:18px 0; font-size:0.9rem;">
      {% if page_obj.has_previous %}
        <a href="?page=1{% if q %}&q={{ q }}{% endif %}"
           style="
             padding:8px 10px;
             border:1px solid #d1d5db;
             border-radius:8px;
             text-decoration:none;
             color:#374151;
           ">
          « Primero
        </a>
        <a href="?page={{ page_obj.previous_page_number }}{% if q %}&q={{ q }}{% endif %}"
           style="
             padding:8px 10px;
             border:1px solid #d1d5db;
             border-radius:8px;
             text-decoration:none;
             color:#374151;
           ">
          ‹ Anterior
        </a>
      {% endif %}

      <span style="
              padding:8px 10px;
              border:1px solid #d1d5db;
              border-radius:8px;
              background:#f3f4f6;
              color:#374151;
            ">
        Página {{ page_obj.number }} de {{ page_obj.paginator.num_pages }}
      </span>

      {% if page_obj.has_next %}
        <a href="?page={{ page_obj.next_page_number }}{% if q %}&q={{ q }}{% endif %}"
           style="
             padding:8px 10px;
             border:1px solid #d1d5db;
             border-radius:8px;
             text-decoration:none;
             color:#374151;
           ">
          Siguiente ›
        </a>
        <a href="?page={{ page_obj.paginator.num_pages }}{% if q %}&q={{ q }}{% endif %}"
           style="
             padding:8px 10px;
             border:1px solid #d1d5db;
             border-radius:8px;
             text-decoration:none;
             color:#374151;
           ">
          Última »
        </a>
      {% endif %}
    </div>
    {% endif %}
  </div>
</main>
{% endblock content %}