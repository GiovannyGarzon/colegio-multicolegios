{% extends "colegioapp/base.html" %}
{% load l10n %}
{% block title %}Notas de Actividad | {{ request.school.name }}{% endblock %}

{% block content %}
<main style="max-width:1100px;margin:0 auto;padding:20px 10px;">

  <h2 style="color:var(--primary-color);margin-bottom:8px;">
    Notas de Actividad
  </h2>

  <!-- Encabezado con info de la actividad -->
  <div style="
      margin:0 auto 16px;
      background:#ffffff;
      border-radius:12px;
      box-shadow:0 4px 12px rgba(0,0,0,0.06);
      padding:16px 20px;
  ">
    <p style="margin:0 0 6px 0;font-size:0.95rem;color:#111827;">
      <strong>Actividad:</strong> {{ actividad.titulo }} &nbsp;•&nbsp;
      <strong>Peso en el logro:</strong> {{ actividad.peso }}%
    </p>

    <p style="margin:0 0 4px 0;color:#4b5563;font-size:0.9rem;">
      <strong>Logro:</strong> {{ logro.titulo }}
    </p>

    {% if actividad.descripcion %}
      <p style="margin:4px 0 0 0;color:#6b7280;font-size:0.9rem;">
        <strong>Descripción de la actividad:</strong>
        {{ actividad.descripcion }}
      </p>
    {% endif %}
  </div>

  <!-- Leyenda de escala -->
  <div style="
      background:rgba(14,116,144,0.06);
      border:1px solid rgba(15,118,110,0.25);
      padding:10px 14px;
      border-radius:10px;
      margin:0 auto 18px;
      color:#0f172a;
      font-size:0.9rem;
  ">
    <strong style="color:var(--primary-color);">Nota:</strong>
    Registra las calificaciones de esta actividad en una escala de
    <strong>0.00 a 5.00</strong>.
    <br>Ejemplo: 3.50 (Aprobado), 4.50 (Sobresaliente), 2.50 (En proceso).
  </div>

  <form method="post" style="margin:0 auto;">
    {% csrf_token %}

    <div style="
        overflow-x:auto;
        background:#ffffff;
        border-radius:12px;
        box-shadow:0 4px 12px rgba(0,0,0,0.06);
    ">
      <table style="width:100%;border-collapse:collapse;">
        <thead style="background:#f1f5f9;">
          <tr>
            <th style="padding:12px;text-align:left;white-space:nowrap;font-size:0.9rem;color:#0f172a;">
              Estudiante
            </th>
            <th style="padding:12px;text-align:center;min-width:140px;font-size:0.9rem;color:#0f172a;">
              Nota de la actividad
            </th>
          </tr>
        </thead>
        <tbody>
          {% for e in estudiantes %}
          <tr style="border-top:1px solid #e5e7eb;">
            <td style="padding:10px 12px;white-space:nowrap;font-size:0.9rem;color:#111827;">
              {{ e.apellidos }} {{ e.nombres }}
            </td>
            <td style="padding:8px 10px;text-align:center;">
              <input
                type="number"
                step="0.01"
                min="0"
                max="5"
                name="nota_{{ e.id }}"
                {% if e.nota_actividad != None %}
                  {% localize off %}value="{{ e.nota_actividad }}"{% endlocalize %}
                {% endif %}
                style="
                  width:120px;
                  padding:8px;
                  border:1px solid #cbd5e1;
                  border-radius:8px;
                  text-align:center;
                  font-size:0.9rem;
                "
              >
            </td>
          </tr>
          {% empty %}
          <tr>
            <td colspan="2" style="padding:16px;text-align:center;color:#6b7280;font-size:0.9rem;">
              No hay estudiantes matriculados en este curso.
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>

    <div style="display:flex;justify-content:space-between;margin-top:16px;gap:10px;">
      <a href="{% url 'academico:actividades' logro.id %}" class="btn-acad-muted">
        ← Volver a actividades del logro
      </a>

      <button type="submit" class="btn-acad">
        Guardar notas de la actividad
      </button>
    </div>
  </form>
</main>

<style>
  .btn-acad{
    background:var(--primary-color);
    color:#ffffff;
    padding:9px 16px;
    border-radius:10px;
    border:none;
    cursor:pointer;
    font-size:0.9rem;
    text-decoration:none;
    display:inline-flex;
    align-items:center;
    gap:4px;
    transition:0.15s ease;
  }
  .btn-acad:hover{
    filter:brightness(1.07);
  }

  .btn-acad-muted{
    background:#9ca3af;
    color:#ffffff;
    padding:9px 16px;
    border-radius:10px;
    text-decoration:none;
    font-size:0.9rem;
    display:inline-flex;
    align-items:center;
    gap:4px;
    transition:0.15s ease;
  }
  .btn-acad-muted:hover{
    background:#6b7280;
  }
</style>
{% endblock %}